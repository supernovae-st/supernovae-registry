# Travel Planner ğŸŒâœˆï¸
# Plan your perfect trip with AI assistance
#
# Usage:
#   DESTINATION="Tokyo" DAYS="5" BUDGET="medium" nika examples/public/travel-planner.nika.yaml
#   DESTINATION="Paris" DAYS="3" INTERESTS="art,food" nika examples/public/travel-planner.nika.yaml
#
# Pattern: Multi-agent orchestration with spawn_agent
# Showcases: agent: verb, spawn_agent tool, complex planning

schema: "nika/workflow@0.5"
workflow: travel-planner
description: "AI-powered travel itinerary generator"
provider: claude

tasks:
  # Step 1: Get parameters
  - id: get_destination
    exec: "echo \"${DESTINATION:-Barcelona}\""

  - id: get_days
    exec: "echo \"${DAYS:-3}\""

  - id: get_budget
    exec: "echo \"${BUDGET:-medium}\""

  - id: get_interests
    exec: "echo \"${INTERESTS:-culture,food,nightlife}\""

  # Step 2: Research destination (agent with spawn for sub-tasks)
  - id: travel_agent
    use:
      destination: get_destination
      days: get_days
      budget: get_budget
      interests: get_interests
    agent:
      prompt: |
        You are an expert travel planner creating a {{use.days}}-day itinerary for {{use.destination}}.

        PARAMETERS:
        - Budget level: {{use.budget}} (low/medium/high)
        - Interests: {{use.interests}}
        - Days: {{use.days}}

        Your job:
        1. Research the destination's highlights
        2. Create a day-by-day itinerary
        3. Include practical tips (transport, timing)
        4. Suggest hidden gems and local favorites
        5. Estimate daily budget

        For each day, provide:
        - Morning activity
        - Lunch recommendation
        - Afternoon activity
        - Dinner spot
        - Evening activity (optional)

        Be specific with names of places, neighborhoods, and approximate costs.
        Consider travel time between locations.

        Output a complete travel plan that feels like a local friend giving advice!
      max_turns: 5

  # Step 3: Generate packing list
  - id: packing_list
    use:
      destination: get_destination
      days: get_days
      plan: travel_agent
    infer:
      prompt: |
        Based on this trip plan to {{use.destination}} for {{use.days}} days:

        {{use.plan}}

        Generate a smart packing list considering:
        - Weather/season
        - Activities planned
        - Cultural norms
        - Travel efficiency

        Format as a checklist:
        ## ğŸ‘• Clothing
        - [ ] Item 1
        - [ ] Item 2

        ## ğŸ’ Essentials
        - [ ] Item 1

        ## ğŸ“± Tech
        - [ ] Item 1

        ## ğŸ’Š Health & Safety
        - [ ] Item 1

        ## ğŸ“„ Documents
        - [ ] Item 1

        Keep it practical, not excessive!

  # Step 4: Compile final plan
  - id: compile
    use:
      destination: get_destination
      days: get_days
      budget: get_budget
      itinerary: travel_agent
      packing: packing_list
    exec: |
      cat > /tmp/travel-plan.md << 'PLAN_EOF'
      # ğŸŒ {{use.destination}} Trip Plan

      **Duration:** {{use.days}} days | **Budget:** {{use.budget}}

      ---

      ## ğŸ“… Itinerary

      {{use.itinerary}}

      ---

      ## ğŸ’ Packing List

      {{use.packing}}

      ---

      *Generated by Travel Planner AI âœˆï¸*
      PLAN_EOF

      echo "âœˆï¸ Trip to {{use.destination}} planned!"
      echo ""
      head -40 /tmp/travel-plan.md
      echo ""
      echo "..."
      echo "ğŸ“„ Full plan saved to /tmp/travel-plan.md"

flows:
  - source: get_destination
    target: travel_agent
  - source: get_days
    target: travel_agent
  - source: get_budget
    target: travel_agent
  - source: get_interests
    target: travel_agent
  - source: travel_agent
    target: packing_list
  - source: packing_list
    target: compile
